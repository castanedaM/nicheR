% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_virtual_species.R
\name{create_virtual_species}
\alias{create_virtual_species}
\title{Create a virtual species end to end}
\usage{
create_virtual_species(
  ...,
  out.file = FALSE,
  out.file.name = NULL,
  verbose = TRUE
)
}
\arguments{
\item{...}{Named arguments passed to the component functions.
Arguments are routed by name to the matching formal parameters of
[build_ellps()], [get_suitable_env()], [set_bias_surface()], and
[get_sample_occ()]. Unknown names are ignored with a warning.
\itemize{
  \item \strong{build_ellps()}: e.g. `center`, `axes`, `angles`, etc.
  \item \strong{get_suitable_env()}: e.g. `env_bg`, `out`, `distances`.
  \item \strong{set_bias_surface()}: e.g. `bias_surface`, `bias_dir`,
        `template`, `res`, `ext`, `out.bias`.
  \item \strong{get_sample_occ()}: e.g. `n_occ`, `method`,
        `bias_surface`, `suitable_env`, `seed`.
}}

\item{out.file}{Logical. If `TRUE`, save the returned object to an `.rds`
file in the working directory.}

\item{out.file.name}{Optional base name (without extension) for the saved
file. If `NULL` or empty, a timestamped name is used.}

\item{verbose}{Logical. If `TRUE`, print progress messages.}
}
\value{
A list of class **NicheR_species** with elements:
\itemize{
  \item \code{niche}: the ellipsoid object returned by [build_ellps()].
  \item \code{suitability}: suitability object from [get_suitable_env()].
  \item \code{bias_surface}: either `NULL`, a \code{nicheR_bias_surface}
        object (if [set_bias_surface()] was used), or a user-supplied
        single-layer bias raster.
  \item \code{occurrences}: sampled occurrences from [get_sample_occ()].
  \item \code{call_args}: the original `...` captured as a named list.
  \item \code{routed_args}: a list showing which args went to each function.
  \item \code{save_path}: file path if \code{out.file = TRUE}, otherwise `NULL`.
}
}
\description{
Orchestrates the full NicheR workflow by routing `...` to
[build_ellps()], [get_suitable_env()], optionally [set_bias_surface()],
and [get_sample_occ()]. Returns an S3 object of class **NicheR_species**
containing the niche object, suitability, (optional) bias surface, and
sampled occurrences.
}
\details{
If `env_bg` is supplied only at the top level, it is forwarded to both
[get_suitable_env()] and [get_sample_occ()] (if those functions accept an
`env_bg` argument). If a required argument (such as `env_bg`) is missing
for a component, the function stops with an informative error.

\strong{Bias handling:}
\itemize{
  \item If the user passes only `bias_surface` (and no `bias_dir`,
        `template`, `res`, `ext`, or `out.bias`), it is assumed to be a
        \emph{precomputed single-layer raster} and is passed directly to
        [get_sample_occ()] (which expects a 0â€“1 layer).
  \item If the user passes `bias_surface` \emph{plus} any of the bias
        construction arguments (`bias_dir`, `template`, `res`, `ext`,
        `out.bias`), then [set_bias_surface()] is called once, and its
        pooled bias raster is passed to [get_sample_occ()] as
        `bias_surface`. The full bias object is stored in the output
        as `bias_surface`.
}
}
\section{Workflow}{

1. Calls [build_ellps()] to define the ellipsoid in E-space.
2. Calls [get_suitable_env()] to compute suitability in G-space.
3. Optionally calls [set_bias_surface()] to build a pooled bias raster
   when bias-construction arguments are supplied (e.g., `bias_dir`,
   `template`, `res`, `ext`, `out.bias`).
4. Calls [get_sample_occ()] to sample occurrences from the suitable
   (and optionally biased) environment.
}

\seealso{
[build_ellps()], [get_suitable_env()], [set_bias_surface()],
  [get_sample_occ()]
}

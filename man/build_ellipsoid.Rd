% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_ellpisoid.R
\name{build_ellipsoid}
\alias{build_ellipsoid}
\title{Build a Probabilistic Ellipsoidal Niche from Ranges}
\usage{
build_ellipsoid(range, cl = 0.99, cov_matrix = NULL, verbose = TRUE)
}
\arguments{
\item{range}{A 2-row `matrix` or `data.frame` of bounds, with variables as
columns. Rows may be ordered as min/max or max/min. Column names must be
provided (variable names).}

\item{cl}{Numeric confidence level in (0, 1). Used to set the chi-square
cutoff that determines the ellipsoid contour (not per-variable limits).}

\item{cov_matrix}{Optional variance–covariance matrix \eqn{\Sigma} for the
ellipsoid (must be `dimensions x dimensions`, symmetric positive definite).
If provided, it is used directly (no rescaling from `range`).}

\item{verbose}{Logical. If `TRUE`, prints brief progress messages.}
}
\value{
An object of class `"nicheR_ellipsoid"` with components:
\itemize{
  \item `dimensions`: number of variables (dimensions).
  \item `mu_vec`: centroid vector \eqn{\mu}.
  \item `cov_matrix`: covariance matrix \eqn{\Sigma}.
  \item `Sigma_inv`: inverse covariance \eqn{\Sigma^{-1}}.
  \item `chol_Sigma`: Cholesky factor of \eqn{\Sigma}.
  \item `eigen`: list with `vectors` and `values` from eigen-decomposition.
  \item `cl`: confidence level used.
  \item `chi2_cutoff`: chi-square cutoff \eqn{c^2}.
  \item `axes_sd`: derived marginal standard deviations (from `range`).
  \item `semi_axes_lengths`: principal semi-axis lengths \eqn{a_i}.
  \item `axis_points`: list of principal-axis endpoint coordinates (LB/UB).
  \item `volume`: ellipsoid hypervolume at the specified contour.
}
}
\description{
Constructs an ellipsoidal niche in multivariate environmental space using a
multivariate normal (MVN) contour of constant Mahalanobis distance. The niche
is defined by a centroid (midpoints of user-provided ranges), per-variable
marginal spreads (derived from ranges), and an optional user-supplied
variance–covariance matrix.
}
\details{
This function expects `range` as a 2-row matrix/data.frame with variables in
columns. The two rows represent lower and upper bounds (order can be min/max
or max/min). The centroid is computed as the midpoint of each variable's
range:
\deqn{\mu_i = (m_i + M_i)/2.}

If `cov_matrix` is not provided, marginal standard deviations are derived from
ranges using the rule-of-thumb that the provided bounds represent roughly
\eqn{\pm 3} standard deviations:
\deqn{\sigma_i = (M_i - m_i)/6,}
and a diagonal covariance matrix is assumed:
\deqn{\Sigma = \mathrm{diag}(\sigma_1^2,\dots,\sigma_n^2).}

The ellipsoid boundary is defined by:
\deqn{(x - \mu)^\top \Sigma^{-1} (x - \mu) = c^2,}
where \eqn{c^2} is the chi-square cutoff \eqn{\chi^2_{n}(\mathrm{cl})} with
\eqn{n} degrees of freedom.

Principal semi-axis lengths are computed from the eigenvalues of \eqn{\Sigma}:
\deqn{a_i = \sqrt{\lambda_i c^2}.}
}
\examples{
rng <- data.frame(bio1 = c(10, 20),
                  bio2 = c(20, 30))
ell <- build_ellipsoid(range = rng, cl = 0.95, verbose = FALSE)
print(ell)

}

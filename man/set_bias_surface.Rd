% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/set_bias_surface.R
\name{set_bias_surface}
\alias{set_bias_surface}
\title{Apply one or more bias surfaces to a suitability raster}
\usage{
set_bias_surface(
  suitable_env,
  bias_surface,
  bias_dir = 1,
  out = c("default", "both")
)
}
\arguments{
\item{suitable_env}{A required \code{terra::SpatRaster} representing the
ecological suitability surface (values typically 0–1).}

\item{bias_surface}{One or more bias layers which may be:
\itemize{
  \item a \code{terra::SpatRaster} (single layer or multi-layer),
  \item a \code{terra::SpatVector} (rasterized to match
        \code{suitable_env}),
  \item a character path to a raster or vector file,
  \item a \code{list} of any of the above.
}}

\item{bias_dir}{Numeric values of \code{1} or \code{-1} controlling
directionality. A length 1 value is recycled across all layers. A value
of \code{-1} applies \code{1 - layer} after scaling to \eqn{[0, 1]}.}

\item{out}{Character, one of \code{"default"} or \code{"both"}, determining
whether to return only the pooled bias and final suitability
(\code{"default"}) or also the individual standardized, direction-adjusted
bias layers (\code{"both"}).}
}
\value{
A list of class \code{"biased_suitable_env"} containing:
  \item{pooled_bias_sp}{Pooled bias raster (scaled 0–1; \code{SpatRaster}).}
  \item{pooled_bias_df}{Data frame version of pooled bias (non-zero cells).}
  \item{final_suitability_sp}{Suitability * pooled bias (\code{SpatRaster}).}
  \item{final_suitability_df}{Data frame version of final suitability
        (non-zero cells).}
  \item{directional_bias_stack}{(If \code{out = "both"}) stack of all
        standardized, direction-corrected bias layers (\code{SpatRaster}).}
  \item{directional_bias_df}{(If \code{out = "both"}) data frame version of
        the directional stack (rows where at least one bias layer > 0).}
  \item{combination_formula}{String describing how layers were combined
        (e.g., \code{"Bias layers were combined: bias_1 * (1-bias_2)"}).}
  \item{is_niche_applied}{Logical, always \code{TRUE} for this function
        (reserved for potential future use).}
}
\description{
This function combines one or more bias layers (sampling probability
surfaces) and applies them to a suitability raster. Each bias layer is:
\itemize{
  \item aligned to the suitability raster,
  \item scaled to \eqn{[0, 1]},
  \item optionally reversed via \eqn{1 - x},
  \item multiplied with other bias layers to form a pooled bias surface.
}
The pooled bias is then multiplied with the ecological suitability raster to
obtain a biased suitability surface.
}
\details{
This function currently expects \code{suitable_env} to be a
\code{terra::SpatRaster}. If you are working with suitability in data.frame
form, you can:
\enumerate{
  \item convert the suitability to a raster before calling,
  \item or use the returned \code{pooled_bias_df} to merge back into your
        data.frame by coordinates.
}
}
\concept{niche functions}
